"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9624],{29624:function(e,n,t){t.d(n,{Z:function(){return Q}});var i=t(82394),l=t(75582),r=t(12691),u=t.n(r),o=t(82684),c=t(83455),s=t(34376),p=t(71180),a=t(50724),d=t(30160),f=t(44897),h=t(42631),g=t(70515),_=t(9518),v=_.default.div.withConfig({displayName:"indexstyle__ModalStyle",componentId:"sc-qldrgc-0"})(["position:absolute;"," "," display:flex;flex-direction:column;width:","px;overflow:hidden;background-color:",";border:1px solid ",";border-radius:","px;box-shadow:",";"],(function(e){return e.top&&"\n    top: ".concat(e.top,"px;\n  ")}),(function(e){return e.left&&"\n    left: ".concat(e.left,"px;\n  ")}),39*g.iI,(function(e){return(e.theme||f.Z).background.dashboard}),(function(e){return(e.theme||f.Z).borders.darkLight}),h.n_,(function(e){return(e.theme||f.Z).shadow.popup})),x=_.default.div.withConfig({displayName:"indexstyle__ContentStyle",componentId:"sc-qldrgc-1"})(["display:flex;flex-direction:column;gap:","px;padding:","px ","px;"],2*g.iI,2.5*g.iI,2*g.iI),y=_.default.div.withConfig({displayName:"indexstyle__ActionsStyle",componentId:"sc-qldrgc-2"})(["display:flex;gap:","px;padding:","px;background-color:",";border-top:1px solid ",";& > *{flex:1;}"],g.iI,2*g.iI,(function(e){return(e.theme||f.Z).background.panel}),(function(e){return(e.theme||f.Z).borders.darkLight})),j=t(72473),b=t(72191),Z=t(79633),m=t(81728),C=t(28598);var P=function(e){var n=e.inProgressRunsCount,t=e.left,i=void 0===t?0:t,l=e.onAllow,r=e.onStop,u=e.pipelineScheduleId,c=e.pipelineUuid,s=e.top,a=void 0===s?0:s,f=e.topOffset,h=void 0===f?0:f,_=(0,o.useRef)(null),P=(0,o.useState)(a+h),k=P[0],w=P[1];return(0,o.useEffect)((function(){var e=null!=_&&_.current?_.current.getBoundingClientRect().height:32*g.iI,n=a+h+e>window.innerHeight;w(n?a-e:a+h)}),[i,a,h]),(0,C.jsxs)(v,{left:i,ref:_,top:k,children:[(0,C.jsxs)(x,{children:[(0,C.jsx)(j.AlertTriangle,{fill:Z.$R,size:b.nz}),(0,C.jsx)(d.ZP,{bold:!0,large:!0,warning:!0,children:"There ".concat(1===n?"is":"are"," currently ").concat((0,m._6)("run",n,!0)," in progress.")}),(0,C.jsx)(d.ZP,{large:!0,children:"Do you want to stop or allow the ".concat((0,m._6)("run",n,!0,!0)," to complete?")})]}),(0,C.jsxs)(y,{children:[(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return r(u,c)},children:"Stop"}),(0,C.jsx)(p.ZP,{large:!0,onClick:function(){return l(u)},children:"Allow"})]})]})},k=t(55485),w=t(48670),I=t(30229),O=t(89515),S=t(38276),R=t(75499),E=t(48381),A=t(69650),D=t(12468),N=t(5332),T=t(77417),q=t(19698),L=t(81655),F=t(41143),U=t(31608),z=t(16488),B=t(3917),V=t(50178),H=t(72619),X=t(95924),$=t(70320),G=t(89538);function M(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?M(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):M(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var J=1.5*g.iI;var Q=function(e){var n=e.disableActions,t=e.fetchPipelineSchedules,i=e.highlightRowOnHover,r=e.includeCreatedAtColumn,f=e.includePipelineColumn,h=e.pipeline,_=e.pipelineSchedules,v=e.pipelineTriggersByName,x=e.selectedSchedule,y=e.setErrors,Z=e.setSelectedSchedule,m=e.stickyHeader,M=null==h?void 0:h.uuid,Q=(0,s.useRouter)(),W=(0,T.Z)().projectPlatformActivated,Y=(0,q.Z)().status,ee=(0,o.useRef)({}),ne=(0,o.useRef)({}),te=(0,o.useState)(null),ie=te[0],le=te[1],re=(0,o.useState)(0),ue=re[0],oe=re[1],ce=(0,o.useState)(0),se=ce[0],pe=ce[1],ae=(0,$.qB)(),de=ae?L.O$:{},fe=(0,c.Db)((function(e){return N.ZP.pipelines.useUpdate(e.uuid)({pipeline:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t()},onErrorCallback:function(e,n){return null==y?void 0:y({errors:n,response:e})}})}}),he=(0,l.Z)(fe,1)[0],ge=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useUpdate(e.id)({pipeline_schedule:e})}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t()},onErrorCallback:function(e,n){return null==y?void 0:y({errors:n,response:e})}})}}),_e=(0,l.Z)(ge,1)[0],ve=(0,c.Db)((function(e){return N.ZP.pipeline_schedules.useDelete(e)()}),{onSuccess:function(e){return(0,H.wD)(e,{callback:function(){null==t||t(),M?Q.push("/pipelines/[pipeline]/triggers","/pipelines/".concat(M,"/triggers")):null==t||t()},onErrorCallback:function(e,n){return y({errors:n,response:e})}})}}),xe=(0,l.Z)(ve,1)[0],ye=[],je=[];n||(ye.push.apply(ye,[null]),je.push.apply(je,[{uuid:"Active"}])),ye.push.apply(ye,[1]),je.push.apply(je,[{uuid:"Name"}]),n||(ye.push.apply(ye,[null]),je.push.apply(je,[{center:!0,uuid:"Logs"}]),W&&(ye.push.apply(ye,[null]),je.push.apply(je,[{uuid:"Project"}])),f&&(ye.push.apply(ye,[1]),je.push.apply(je,[{uuid:"Pipeline"}])),ye.push.apply(ye,[null,null]),je.push.apply(je,[{uuid:"Type"},{uuid:"Frequency"}])),ye.push.apply(ye,[1,1,null,null]),je.push.apply(je,[{uuid:"Latest status"},K(K({},de),{},{uuid:"Next run date"}),{uuid:"Runs"},{uuid:"Description"}]),n||(ye.push.apply(ye,[1]),je.push.apply(je,[{uuid:"Tags"}]),r&&(ye.push.apply(ye,[null]),je.push.apply(je,[K(K({},de),{},{uuid:"Created at"})])),(0,V.Ct)()||(ye.push.apply(ye,[null]),je.push.apply(je,[{label:function(){return""},uuid:"edit/delete"}])));var be=(0,G.dd)((function(e){var n=e.inProgressRunsCount,t=e.left,i=e.pipelineScheduleId,l=e.pipelineUuid,r=e.top,u=e.topOffset;return(0,C.jsx)(P,{inProgressRunsCount:n,left:t,onAllow:function(e){Ce(),_e({id:e,status:I.fq.INACTIVE})},onStop:function(e,n){Ce(),he({pipeline_schedule_id:e,status:F.V.CANCELLED,uuid:n}),_e({id:e,status:I.fq.INACTIVE})},pipelineScheduleId:i,pipelineUuid:l,top:r,topOffset:u})}),{},[],{background:!0,uuid:"disable_trigger"}),Ze=(0,l.Z)(be,2),me=Ze[0],Ce=Ze[1];return(0,C.jsx)(U.cl,{overflowVisible:!0,children:0===_.length?(0,C.jsx)(S.Z,{px:3,py:1,children:(0,C.jsx)(d.ZP,{bold:!0,default:!0,monospace:!0,muted:!0,children:"No triggers available"})}):(0,C.jsx)(R.Z,{columnFlex:ye,columns:je,highlightRowOnHover:i,isSelectedRow:function(e){return _[e].id===(null==x?void 0:x.id)},onClickRow:Z?function(e){return null==Z?void 0:Z(_[e])}:null,rowVerticalPadding:6,rows:_.map((function(e,t){var i=e.id,l=e.created_at,c=e.description,s=e.next_pipeline_run_date,h=e.pipeline_in_progress_runs_count,_=e.pipeline_runs_count,x=e.pipeline_uuid,y=e.last_pipeline_run_status,Z=e.name,m=e.repo_path,P=e.schedule_interval,R=e.status,N=e.tags,T=I.fq.ACTIVE===R,q=(0,z._U)(P),F=M||x;ee.current[i]=(0,o.createRef)(),ne.current[i]=(0,o.createRef)();var U=null!=v&&v[Z]?(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(D.Z,{block:!0,label:"This trigger is saved in code.",size:J,widthFitContent:!0,children:(0,C.jsx)(j.Code,{default:!0,size:J})})]}):null,H=[];if(n?H.push.apply(H,[(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(d.ZP,{bold:!0,children:Z}),U]},"trigger_name_".concat(t))]):H.push.apply(H,[(0,C.jsx)(D.Z,{block:!0,label:R,size:20,widthFitContent:!0,children:(0,C.jsx)("div",{ref:ee.current[i],style:{position:"relative"},children:(0,C.jsx)(A.Z,{checked:T,compact:!0,onCheck:function(e){return function(e){var n=e.event,t=e.inProgressRunsCount,i=e.pipelineIsActive,l=e.pipelineScheduleId,r=e.pipelineUuid;if((0,X.j)(n),i&&t>0){var u,o=null===(u=ee.current[l])||void 0===u?void 0:u.current,c=null==o?void 0:o.getBoundingClientRect(),s=c.height,p=c.left,a=c.top;me({inProgressRunsCount:t,left:p,pipelineScheduleId:l,pipelineUuid:r,top:a,topOffset:s})}else _e({id:l,status:i?I.fq.INACTIVE:I.fq.ACTIVE})}({event:e,inProgressRunsCount:h,pipelineIsActive:T,pipelineScheduleId:i,pipelineUuid:x})},purpleBackground:!0})})},"trigger_enabled_".concat(t)),(0,C.jsxs)(k.ZP,{alignItems:"center",children:[(0,C.jsx)(u(),{as:"/pipelines/".concat(F,"/triggers/").concat(i),href:"/pipelines/[pipeline]/triggers/[...slug]",passHref:!0,children:(0,C.jsx)(w.Z,{bold:!0,onClick:function(e){(0,X.j)(e),Q.push("/pipelines/[pipeline]/triggers/[...slug]","/pipelines/".concat(F,"/triggers/").concat(i))},sky:!0,children:Z})}),U]},"trigger_name_".concat(t))]),!n){var $,G;if(H.push((0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return Q.push("/pipelines/".concat(F,"/logs?pipeline_schedule_id[]=").concat(i))},children:(0,C.jsx)(j.Logs,{default:!0,size:b.bL})},"logs_button_".concat(t))),W)H.push.apply(H,[(0,C.jsx)(d.ZP,{default:!0,monospace:!0,children:null==m||null===(G=m.replace((null==Y?void 0:Y.repo_path_root)||"",""))||void 0===G?void 0:G.slice(1)},"project_".concat(t))]);f&&H.push((0,C.jsx)(d.ZP,{default:!0,monospace:!0,children:F},"pipeline_name_".concat(t))),H.push.apply(H,[(0,C.jsx)(d.ZP,{default:!0,monospace:!0,children:null===($=I.Z4[e.schedule_type])||void 0===$?void 0:$.call(I.Z4)},"trigger_type_".concat(t)),(0,C.jsx)(d.ZP,{default:!0,monospace:!0,children:ae&&q?(0,z.lO)(P):P},"trigger_frequency_".concat(t))])}return H.push.apply(H,[(0,o.createElement)(d.ZP,K(K({},(0,L.NC)(y)),{},{key:"latest_run_status_".concat(t)}),y||"—"),(0,C.jsx)(d.ZP,{monospace:!0,small:!0,title:s?"UTC: ".concat(s.slice(0,19)):null,children:s?ae?(0,B.XG)(s,ae):(0,B.d$)(s,{includeSeconds:!0,utcFormat:!0}):(0,C.jsx)(C.Fragment,{children:"—"})},"trigger_next_run_date_".concat(t)),(0,C.jsx)(d.ZP,{default:!0,monospace:!0,children:_||"0"},"trigger_run_count_".concat(t)),(0,C.jsx)(d.ZP,{default:!0,title:c,width:40*g.iI,children:c},"trigger_description_".concat(t))]),n||(H.push((0,C.jsx)("div",{children:(0,C.jsx)(E.Z,{tags:null==N?void 0:N.map((function(e){return{uuid:e}}))})},"pipeline_tags_".concat(t))),r&&H.push((0,C.jsx)(d.ZP,{default:!0,monospace:!0,small:!0,title:l?(0,B._6)(l):null,children:(0,B.XG)(null==l?void 0:l.slice(0,19),ae)},"created_at_".concat(t))),(0,V.Ct)()||H.push((0,C.jsxs)(k.ZP,{children:[(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){return Q.push("/pipelines/".concat(F,"/triggers/").concat(i,"/edit"))},title:"Edit",children:(0,C.jsx)(j.Edit,{default:!0,size:b.bL})}),(0,C.jsx)(S.Z,{mr:1}),(0,C.jsx)(p.ZP,{default:!0,iconOnly:!0,noBackground:!0,onClick:function(){var e,n,t,l;le(i),oe((null===(e=ne.current[i])||void 0===e||null===(n=e.current)||void 0===n?void 0:n.offsetTop)||0),pe((null===(t=ne.current[i])||void 0===t||null===(l=t.current)||void 0===l?void 0:l.offsetLeft)||0)},ref:ne.current[i],title:"Delete",children:(0,C.jsx)(j.Trash,{default:!0,size:b.bL})}),(0,C.jsx)(a.Z,{onClickOutside:function(){return le(null)},open:ie===i,children:(0,C.jsx)(O.Z,{danger:!0,left:(se||0)-L.nH,onCancel:function(){return le(null)},onClick:function(){le(null),xe(i)},title:"Are you sure you want to delete the trigger ".concat(Z,"?"),top:(ue||0)-(t<=1?L.oz:L.OK),width:L.Xx})})]},"edit_delete_buttons_".concat(t)))),H})),stickyHeader:m,uuid:"pipeline-triggers"})})}},19698:function(e,n,t){var i=t(82684),l=t(5332),r=t(59457);n.Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.delay,t=void 0===n?7e3:n,u=e.pauseFetch,o=e.refreshInterval,c=e.revalidateOnFocus,s=(0,r.Z)(l.ZP.statuses.list,{},{refreshInterval:o,revalidateOnFocus:c},{delay:t,condition:function(){return!u}}).data;return{status:(0,i.useMemo)((function(){var e;return null==s||null===(e=s.statuses)||void 0===e?void 0:e[0]}),[s])}}}}]);