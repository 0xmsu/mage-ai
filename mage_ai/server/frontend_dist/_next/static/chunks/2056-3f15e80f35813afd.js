"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2056],{74521:function(e,t,n){var i=n(82394),r=n(92083),l=n.n(r),o=n(15338),u=n(97618),s=n(55485),a=n(65956),c=n(38276),d=n(71417),p=n(75499),m=n(30160),f=n(5332),h=n(3917),g=n(70515),v=n(8970),_=n(88422),j=n(10332),x=n(86735),b=n(70320),y=n(28598),E=n(82684);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableJobExpansion,n=e.disableStageExpansion,i=e.jobs,r=e.stagesMapping,k=(0,b.qB)();return(0,y.jsx)(p.Z,{apiForFetchingAfterAction:t?null:f.ZP.spark_jobs.detail,buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null==e?void 0:e.job_id,{application_id:null!=e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null==e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!=e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null==e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):""}]},columnFlex:[null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Name"},{uuid:"Submitted"},{uuid:"Status"},{center:!0,uuid:"Stages"},{center:!0,uuid:"Tasks"}],getObjectAtRowIndex:function(e){return null==i?void 0:i[e]},renderExpandedRowWithObject:t?null:function(e,t){var i=null==t?void 0:t.spark_job;if(i){var l=i.num_active_stages,p=i.num_active_tasks,f=i.num_completed_stages,h=i.num_completed_tasks,v=i.num_failed_stages,_=i.num_failed_tasks,b=i.num_killed_tasks,E=i.num_skipped_stages,k=i.num_skipped_tasks,P=i.num_tasks,Z=i.stage_ids,O=(0,x.YC)(Z,(function(e){return e}),{ascending:!1}).reduce((function(e,t){var n,l,o=null==r||null===(n=r[null==i||null===(l=i.application)||void 0===l?void 0:l.calculated_id])||void 0===n?void 0:n[t];return o?e.concat(o):o}),[]);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(c.Z,{p:g.cd,children:(0,y.jsxs)(s.ZP,{children:[(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(a.Z,{noPadding:!0,children:[(0,y.jsx)(c.Z,{px:g.cd,py:g.cd,children:(0,y.jsx)(m.ZP,{bold:!0,large:!0,children:"Stage summary"})}),(0,y.jsx)(o.Z,{light:!0,short:!0}),(0,j.s)([["IDs",null==Z?void 0:Z.join(", ")],["Completed",f],["Active",l],["Skipped",E],["Failed",v]])]})}),(0,y.jsx)(c.Z,{mr:g.cd}),(0,y.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,y.jsxs)(a.Z,{noPadding:!0,children:[(0,y.jsx)(c.Z,{px:g.cd,py:g.cd,children:(0,y.jsx)(m.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,y.jsx)(o.Z,{light:!0,short:!0}),(0,j.s)([["Total",P],["Completed",h],["Active",p],["Skipped",k],["Failed",_],["Killed",b]])]})})]})}),(0,y.jsx)(o.Z,{light:!0}),(0,y.jsx)(c.Z,{p:g.cd,children:(0,y.jsxs)(a.Z,{noPadding:!0,children:[(0,y.jsx)(c.Z,{p:g.cd,children:(0,y.jsxs)(m.ZP,{bold:!0,large:!0,children:["Stages   ",(0,y.jsx)(m.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:null==O?void 0:O.length})]})}),(0,y.jsx)(o.Z,{light:!0}),(0,y.jsx)(d.Z,{disableStageExpansion:n,stages:O}),(0,y.jsx)(c.Z,{p:g.cd})]})})]})}return(0,y.jsx)(c.Z,{p:g.cd})},rows:null==i?void 0:i.map((function(e){var t=e.job_id,n=e.name,i=e.num_tasks,r=e.stage_ids,o=e.status,u=e.submission_time,s=(null==n?void 0:n.length)>=100?"".concat(null==n?void 0:n.slice(0,97),"..."):n;return[(0,E.createElement)(m.ZP,P(P({},v.eB),{},{key:"id"}),t),(0,E.createElement)(m.ZP,P(P({},v.eB),{},{key:"name",preWrap:!0,title:n}),s),(0,E.createElement)(m.ZP,P(P({},v.eB),{},{key:"submittedAt"}),u?(0,h.XG)(l()(u,h.kE).format(h.BL),k):"-"),(0,E.createElement)(m.ZP,P(P({},v.eB),{},{danger:_.CN.FAILED===o,key:"status",success:_.CN.SUCCEEDED===o}),o),(0,E.createElement)(m.ZP,P(P({},v.eB),{},{center:!0,key:"stageIds"}),(null==r?void 0:r.length)||"-"),(0,E.createElement)(m.ZP,P(P({},v.eB),{},{center:!0,key:"tasks"}),i)]})),uuid:"jobs"})}},72748:function(e,t,n){n.d(t,{Z:function(){return M}});var i=n(21831),r=n(82394),l=n(9518),o=n(82684),u=n(75499),s=n(30160),a=n(44897),c=n(42631),d=n(31608),p=n(70515),m=d.DI,f=2*p.iI,h=5*p.iI+2*f,g=l.default.div.withConfig({displayName:"indexstyle__NodeStyle",componentId:"sc-9bk2jw-0"})(["border-radius:","px;"," ",""],c.n_,(function(e){return"\n    background-color: ".concat((e.theme||a.Z).background.dashboard,";\n    border: 1px solid ").concat((e.theme||a.Z).borders.light,";\n  ")}),(function(e){return e.height&&"\n    height: ".concat(e.height,"px;\n  ")})),v=l.default.div.withConfig({displayName:"indexstyle__NodeHeaderStyle",componentId:"sc-9bk2jw-1"})(["padding-left:","px;padding-right:","px;padding-top:","px;padding-bottom:","px;",""],m,m,f,f,(function(e){return"\n    border-bottom: 1px solid ".concat((e.theme||a.Z).borders.light,";\n  ")})),_=n(8970),j=n(28598);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var y=function(e){var t=e.height,n=e.node,i=(0,o.useMemo)((function(){return(null==n?void 0:n.metrics)||[]}),n),r=(0,o.useMemo)((function(){return(0,j.jsx)(u.Z,{columnFlex:[null,null],columns:[{uuid:"Metric"},{rightAligned:!0,uuid:"Value"}],rows:null==i?void 0:i.map((function(e){var t=e.name,n=e.value;return[(0,o.createElement)(s.ZP,b(b({},_.eB),{},{key:"name"}),t),(0,o.createElement)(s.ZP,b(b({},_.eB),{},{key:"value",rightAligned:!0}),n)]}))})}),[i]);return(0,j.jsxs)(g,{height:t,children:[(0,j.jsx)(v,{children:(0,j.jsx)(s.ZP,{monospace:!0,children:null==n?void 0:n.node_name})}),(null==i?void 0:i.length)>=1&&r]})},E=n(5332),k=n(24138),P=n(21978),Z=n(55187),O=n(99543);function S(e){var t=(null==e?void 0:e.metrics)||[],n=h,i=new RegExp("\n","g"),r=0;null==t||t.forEach((function(e){var t=e.name,n=e.value;r+=1;var l=[];[t,n].forEach((function(e){var t=e.matchAll(i);if(t){for(var n=0;void 0!==t.next().value;)n+=1;l.push(n)}})),r+=Math.max.apply(Math,l)}));var l=(null==t?void 0:t.length)||0;return l>=1&&(n+=37,n+=18*(r||0),n+=17*(l||0)),n}var w=n(86735);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=function(e){var t,n,r,u,s=e.disableGraph,a=e.height,c=e.heightOffset,d=e.model,p=e.overrideScroll,f=e.treeRef,h=(0,o.useRef)(null),g=f||h,v=(0,o.useContext)(l.ThemeContext),_=E.ZP.spark_sqls.detail(null==d?void 0:d.id,{application_id:null!=d&&null!==(t=d.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null==d||null===(n=d.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!=d&&null!==(r=d.application)&&void 0!==r&&r.spark_ui_url?encodeURIComponent(null==d||null===(u=d.application)||void 0===u?void 0:u.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}).data,x=(0,o.useMemo)((function(){return null==_?void 0:_.spark_sql}),[_]),b=(0,o.useMemo)((function(){return(0,w.HK)((null==x?void 0:x.jobs)||[],(function(e){return e.job_id}))}),[x]),C=(0,o.useMemo)((function(){return(0,w.HK)((null==x?void 0:x.stages)||[],(function(e){return e.stage_id}))}),[x]),M=(0,o.useMemo)((function(){var e,t=[],n=[],r=(null==x?void 0:x.edges)||[],l=((0,w.vM)(r,(function(e){return e.from_id})),(0,w.vM)(r,(function(e){return e.to_id})),{});return null==r||r.forEach((function(e){var t=e.from_id,i=e.to_id;n.push({from:t,fromPort:"".concat(t,"-").concat(i,"-from"),id:"".concat(t,"-").concat(i),to:i,toPort:"".concat(t,"-").concat(i,"-to")}),t in l||(l[t]=[]),l[t].push(R(R({},P.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-from"),side:P.rl.SOUTH})),i in l||(l[i]=[]),l[i].push(R(R({},P.bJ),{},{disabled:!0,id:"".concat(t,"-").concat(i,"-to"),side:P.rl.NORTH}))})),null==x||null===(e=x.nodes)||void 0===e||e.forEach((function(e){var n,r,o,u,s,a=null==e?void 0:e.node_id,c=(0,i.Z)((null==l?void 0:l[a])||[]);t.push({data:{sqlNode:e},height:S(e),id:a,ports:c,width:(n=e,r=(null==n?void 0:n.node_name)||"",o=(null==n?void 0:n.metrics)||[],u=Math.max.apply(Math,[(null==r?void 0:r.length)||0].concat((0,i.Z)(null==o?void 0:o.map((function(e){var t=e.name,n=e.value;return((null==t?void 0:t.length)||0)+((null==n?void 0:n.length)||0)}))))),s=2*m+u*(O.YE+.3),null!=o&&o.length&&(s+=4*m),s)})})),{edges:n,nodes:t}}),[b,x,C]),I=M.edges,A=M.nodes;(0,o.useEffect)((function(){s||setTimeout((function(){var e,t,n,i,r;0===(null==g||null===(e=g.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n?void 0:n.scrollTop)&&(null==g||null===(i=g.current)||void 0===i||null===(r=i.fitCanvas)||void 0===r||r.call(i))}),1e3)}),[g,s]);var T=(0,o.useMemo)((function(){var e=0;return a&&(e+=a),c&&(e-=c),Math.max(0,e)}),[a,c]),D=(0,o.useCallback)((function(e){e.preventDefault()}),[]);(0,o.useEffect)((function(){var e,t,n,i,r,l;s?null==g||null===(e=g.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",D):null==g||null===(i=g.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(l=r.current)||void 0===l||l.removeEventListener("wheel",D)}),[s,D]);var N=(0,o.useCallback)((function(e){e.stopPropagation()}),[]);return(0,o.useEffect)((function(){var e,t,n,i,r,l;p?null==g||null===(e=g.current)||void 0===e||null===(t=e.containerRef)||void 0===t||null===(n=t.current)||void 0===n||n.addEventListener("wheel",N):null==g||null===(i=g.current)||void 0===i||null===(r=i.containerRef)||void 0===r||null===(l=r.current)||void 0===l||l.removeEventListener("wheel",N)}),[p,N]),(0,j.jsx)(Z.$4,{height:T,onDoubleClick:function(){var e,t;return null==g||null===(e=g.current)||void 0===e||null===(t=e.fitCanvas)||void 0===t?void 0:t.call(e)},children:(0,j.jsx)(k.Xz,{arrow:null,disabled:s,edge:function(e){var t;return(0,j.jsx)(k.kS,R(R({},e),{},{style:{stroke:null==v||null===(t=v.accent)||void 0===t?void 0:t.purple}}))},edges:I,fit:!0,forwardedRef:g,maxHeight:P.Jo,maxWidth:P.Jo,maxZoom:1,minZoom:-.7,node:function(e){var t,n;return(0,j.jsx)(k.NB,R(R({},e),{},{dragType:"port",linkable:!0,port:(0,j.jsx)(k.GR,{style:{fill:null==v||null===(t=v.borders)||void 0===t?void 0:t.light,stroke:null==v||null===(n=v.accent)||void 0===n?void 0:n.purple,strokeWidth:"1px"}}),style:{fill:"transparent",stroke:"transparent",strokeWidth:0},children:function(e){var t=e.height,n=e.node.data.sqlNode;return(0,j.jsx)("foreignObject",{height:t,width:e.width,x:0,y:0,children:(0,j.jsx)(y,{height:t,node:n})})}}))},nodes:A})})}},93004:function(e,t,n){var i=n(82394),r=n(92083),l=n.n(r),o=n(82684),u=n(32013),s=n(98777),a=n(15338),c=n(97618),d=n(55485),p=n(74521),m=n(85854),f=n(65956),h=n(38276),g=n(72748),v=n(75499),_=n(30160),j=n(5332),x=n(3917),b=n(70515),y=n(8970),E=n(88422),k=n(81728),P=n(70320),Z=n(28598);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.Z=function(e){var t=e.disableGraph,n=e.disableJobExpansion,i=e.overrideScrollForGraph,r=e.setSelectedSql,O=e.showSparkGraph,w=e.sqls,C=e.stagesMapping,R=(0,P.qB)(),M=j.ZP.spark_sqls.list({length:9999},{},{pauseFetch:null!=w}).data,I=(0,o.useMemo)((function(){return w||((null==M?void 0:M.spark_sqls)||[])}),[M,w]),A=(0,o.useMemo)((function(){var e,P={};null==I||I.forEach((function(e){var t,n,i=null==e?void 0:e.application;(null==i?void 0:i.calculated_id)in P||(P[null==i?void 0:i.calculated_id]={application:i,sqls:[]}),null===(t=P[null==i?void 0:i.calculated_id])||void 0===t||null===(n=t.sqls)||void 0===n||n.push(e)}));var w=null===(e=Object.values(P))||void 0===e?void 0:e.length;return Object.values(P).map((function(e){var P=e.application,M=e.sqls;return(0,Z.jsxs)("div",{children:[w>=2&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(h.Z,{p:b.cd,children:(0,Z.jsxs)(_.ZP,{default:!0,bold:!0,children:["Application ",null==P?void 0:P.calculated_id]})}),(0,Z.jsx)(a.Z,{light:!0})]}),(0,Z.jsx)(v.Z,{apiForFetchingAfterAction:j.ZP.spark_sqls.detail,buildApiOptionsFromObject:function(e){var t,n,i,r;return[null==e?void 0:e.id,{application_id:null!=e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null==e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!=e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null==e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",include_jobs_and_stages:1,_format:"with_jobs_and_stages"}]},columnFlex:[null,null,null,null,null,null,null],columns:[{uuid:"ID"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Successful jobs"},{center:!0,uuid:"Running jobs"},{center:!0,uuid:"Failed jobs"}],getObjectAtRowIndex:function(e){return null==M?void 0:M[e]},onClickRow:function(e){var t=null==M?void 0:M[e];null==r||r((function(e){return e&&(null==e?void 0:e.id)===(null==t?void 0:t.id)?null:t}))},renderExpandedRowWithObject:function(e,r){var l,o=null==r||null===(l=r.spark_sql)||void 0===l?void 0:l.jobs,a=null==M?void 0:M[e];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(h.Z,{p:b.cd,children:(0,Z.jsxs)(f.Z,{noPadding:!0,children:[(0,Z.jsx)(h.Z,{p:b.cd,children:(0,Z.jsx)(d.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,Z.jsxs)(c.Z,{flex:1,flexDirection:"column",children:[(0,Z.jsx)(m.Z,{level:5,children:"Description"}),(0,Z.jsx)(h.Z,{mt:1,children:(0,Z.jsx)(_.ZP,{default:!0,monospace:!0,children:null==a?void 0:a.description})})]})})}),(0,Z.jsx)(h.Z,{p:b.cd,children:(0,Z.jsxs)(u.Z,{noBoxShadow:!0,children:[(0,Z.jsx)(s.Z,{noPaddingContent:!0,title:"Plan",titleXPadding:b.cd*b.iI,titleYPadding:1.5*b.iI,children:(0,Z.jsx)(h.Z,{p:b.cd,children:(0,Z.jsx)(_.ZP,{default:!0,monospace:!0,preWrap:!0,small:!0,children:null==a?void 0:a.plan_description})})}),O&&(0,Z.jsx)(s.Z,{noPaddingContent:!0,title:"Graph",titleXPadding:b.cd*b.iI,titleYPadding:1.5*b.iI,children:(0,Z.jsx)(g.Z,{disableGraph:t,height:100*b.iI,model:a,overrideScroll:i})})]})})]})}),(0,Z.jsxs)(h.Z,{mb:b.cd,px:b.cd,children:[(0,Z.jsx)(h.Z,{mb:b.cd,children:(0,Z.jsx)(d.ZP,{alignItems:"center",justifyContent:"space-between",children:(0,Z.jsx)(c.Z,{flex:1,flexDirection:"column",children:(0,Z.jsx)(m.Z,{level:5,children:"Jobs"})})})}),(0,Z.jsxs)(f.Z,{overflowVisible:!0,noPadding:!0,children:[(0,Z.jsx)(p.Z,{disableJobExpansion:n,jobs:o,stagesMapping:C}),(0,Z.jsx)(h.Z,{pb:b.cd})]})]})]})},rows:null==M?void 0:M.map((function(e){var t=e.duration,n=e.failed_job_ids,i=e.id,r=e.running_job_ids,u=e.status,s=e.submission_time,a=e.success_job_ids;return[(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"id"}),i),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"submissionTime"}),s?(0,x.XG)(l()(s,x.kE).format(x.OC),R):"-"),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"duration"}),t?(0,k.NR)(t):0),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{key:"status",success:E.oD.COMPLETED===u}),u),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"successJobIds"}),null==a?void 0:a.length),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"runningJobIds"}),null==r?void 0:r.length),(0,o.createElement)(_.ZP,S(S({},y.eB),{},{center:!0,key:"failedJobIds"}),null==n?void 0:n.length)]}))})]},null==P?void 0:P.calculated_id)}))}),[t,i,I,C]);return(0,Z.jsx)(Z.Fragment,{children:A})}},71417:function(e,t,n){n.d(t,{Z:function(){return N}});var i=n(82394),r=n(92083),l=n.n(r),o=n(15338),u=n(97618),s=n(55485),a=n(65956),c=n(38276),d=n(75499),p=n(9518),m=n(82684),f=n(39867),h=n(30160),g=n(12468),v=n(44897),_=n(70515),j=3*_.iI,x=p.default.div.withConfig({displayName:"indexstyle__BarsContainerStyle",componentId:"sc-15hlddf-0"})(["width:100%;"]),b=p.default.div.withConfig({displayName:"indexstyle__BarContainerStyle",componentId:"sc-15hlddf-1"})(["align-items:center;display:flex;height:","px;width:100%;"],j),y=p.default.div.withConfig({displayName:"indexstyle__BarStyle",componentId:"sc-15hlddf-2"})(["height:100%;"," "," "," "," "," "," "," "," ",""],(function(e){return e.widthPercentage&&"\n    width: ".concat(100*e.widthPercentage,"%;\n  ")}),(function(e){return e.blue&&"\n    background-color: ".concat((e.theme||v.Z).accent.blue,";\n  ")}),(function(e){return e.green&&"\n    background-color: ".concat((e.theme||v.Z).accent.positive,";\n  ")}),(function(e){return e.orange&&"\n    background-color: ".concat((e.theme||v.Z).accent.dbt,";\n  ")}),(function(e){return e.purple&&"\n    background-color: ".concat((e.theme||v.Z).accent.purple,";\n  ")}),(function(e){return e.red&&"\n    background-color: ".concat((e.theme||v.Z).accent.negative,";\n  ")}),(function(e){return e.teal&&"\n    background-color: ".concat((e.theme||v.Z).accent.teal,";\n  ")}),(function(e){return e.yellow&&"\n    background-color: ".concat((e.theme||v.Z).accent.yellow,";\n  ")}),(function(e){return e.empty&&"\n    background-color: ".concat((e.theme||v.Z).background.chartBlock,";\n  ")})),E=p.default.div.withConfig({displayName:"indexstyle__FillerStyle",componentId:"sc-15hlddf-3"})(["height:","px;width:100%;"],j),k=p.default.div.withConfig({displayName:"indexstyle__TextStyle",componentId:"sc-15hlddf-4"})(["align-items:center;display:flex;height:","px;justify-content:flex-end;"],j),P=n(3917),Z=n(70320),O=n(86735),S=n(28598);var w=function(e){var t,n=e.stageAttempt,i=(0,m.useContext)(p.ThemeContext),r=(0,Z.qB)(),o=(n.submission_time,(0,m.useMemo)((function(){return(0,O.YC)(Object.values((null==n?void 0:n.tasks)||{}),(function(e){return e.launch_time}),{ascending:!0})}),[n])),a=(0,m.useMemo)((function(){var e,t;return null==o||o.forEach((function(n){var i=n.duration,r=n.launch_time,o=l()(r,P.kE).valueOf();(!t||o<t)&&(t=o);var u=o+i;(!e||u>e)&&(e=u)})),{maxEndTimestamp:e,minLaunchTimestamp:t}}),[o]),d=a.maxEndTimestamp,v=a.minLaunchTimestamp,j=(0,m.useCallback)((function(e){return(0,S.jsx)(g.Z,{appearAbove:!0,block:!0,fullSize:!0,label:(0,S.jsx)(h.ZP,{leftAligned:!0,children:e}),lightBackground:!0,muted:!0,widthFitContent:!0,children:(0,S.jsx)(E,{})})}),[]),w=(0,m.useMemo)((function(){var e=d-v,t=[];return null==o||o.forEach((function(n,i){var r=n.duration,o=n.task_id,u=n.launch_time,s=n.scheduler_delay,a=n.task_metrics,p=a.executor_deserialize_time,m=a.shuffle_read_metrics.fetch_wait_time,f=a.executor_run_time,h=a.shuffle_write_metrics.write_time,g=a.result_serialization_time,_=n.getting_result_time,x=l()(u,P.kE).valueOf(),E=x+r,k=[(0,S.jsx)(y,{empty:!0,widthPercentage:(x-v)/e,children:j("Waiting to start")},"launchTimestamp"),(0,S.jsx)(y,{blue:!0,widthPercentage:s/e,children:j("Scheduler delay")},"schedulerDelay"),(0,S.jsx)(y,{red:!0,widthPercentage:p/e,children:j("Task deserialization time")},"executorDeserializeTime"),(0,S.jsx)(y,{orange:!0,widthPercentage:m/e,children:j("Shuffle read time")},"fetchWaitTime"),(0,S.jsx)(y,{green:!0,widthPercentage:f/e,children:j("Executor computing time")},"executorRunTime"),(0,S.jsx)(y,{widthPercentage:h/e,yellow:!0,children:j("Shuffle write time")},"writeTime"),(0,S.jsx)(y,{purple:!0,widthPercentage:g/e,children:j("Result serialization time")},"resultSerializationTime"),(0,S.jsx)(y,{teal:!0,widthPercentage:_/e,children:j("Getting result time")},"gettingResultTime"),(0,S.jsx)(y,{empty:!0,widthPercentage:(d-E)/e,children:j("Already finished")},"endTime")];t.push((0,S.jsx)(c.Z,{mt:1},"divider-".concat(o))),t.push((0,S.jsx)(b,{children:k},o))})),(0,S.jsxs)(x,{children:[(0,S.jsx)(b,{children:(0,S.jsxs)(s.ZP,{fullWidth:!0,justifyContent:"space-between",children:[(0,S.jsx)(u.Z,{flex:1,children:(0,S.jsx)(h.ZP,{monospace:!0,muted:!0,children:(0,P.XG)((0,P.Mg)(v,{withMilliseconds:!0}).format(P.OC),r)})}),(0,S.jsx)(u.Z,{flex:1,justifyContent:"flex-end",children:(0,S.jsx)(h.ZP,{monospace:!0,muted:!0,children:(0,P.XG)((0,P.Mg)(d,{withMilliseconds:!0}).format(P.OC),r)})})]})}),t]})}),[d,v,j,o]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.Z,{mb:_.cd,children:(0,S.jsx)(h.ZP,{bold:!0,large:!0,children:"Task timeline"})}),(0,S.jsx)(c.Z,{mb:_.cd,children:[{color:null==i||null===(t=i.accent)||void 0===t?void 0:t.blue,uuid:"Scheduler delay"},{color:null==i?void 0:i.accent.negative,uuid:"Task deserialization time"},{color:null==i?void 0:i.accent.dbt,uuid:"Shuffle read time"},{color:null==i?void 0:i.accent.positive,uuid:"Executor computing time"},{color:null==i?void 0:i.accent.yellow,uuid:"Shuffle write time"},{color:null==i?void 0:i.accent.purple,uuid:"Result serialization time"},{color:null==i?void 0:i.accent.teal,uuid:"Getting result time"}].map((function(e,t){var n=e.color,i=e.uuid;return(0,S.jsx)(c.Z,{mt:t>=1?1:0,children:(0,S.jsxs)(s.ZP,{alignItems:"center",children:[(0,S.jsx)(f.Z,{color:n,size:1*_.iI}),(0,S.jsx)(c.Z,{mr:1}),(0,S.jsx)(h.ZP,{default:!0,children:i})]})},i)}))}),(0,S.jsxs)(s.ZP,{children:[(0,S.jsxs)("div",{children:[(0,S.jsx)(k,{children:(0,S.jsx)(h.ZP,{bold:!0,monospace:!0,muted:!0,noWrapping:!0,children:"ID"})}),null==o?void 0:o.map((function(e,t){var n=e.task_id;return(0,S.jsx)(c.Z,{mt:1,children:(0,S.jsx)(k,{children:(0,S.jsx)(h.ZP,{default:!0,monospace:!0,noWrapping:!0,children:n})})},n)}))]}),(0,S.jsx)(c.Z,{mr:2}),w]})]})},C=n(5332),R=n(88422),M=n(8970),I=n(10332),A=n(81728);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=function(e){var t=e.disableStageExpansion,n=e.stages,i=e.tasksContained,r=(0,Z.qB)();return(0,S.jsx)(d.Z,{columnFlex:[null,null,null,null,null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Name"},{uuid:"Submitted"},{center:!0,uuid:"Duration"},{uuid:"Status"},{center:!0,uuid:"Tasks"},{center:!0,tooltipMessage:"Bytes read from storage in this stage",uuid:"In"},{center:!0,uuid:"In recs"},{center:!0,tooltipMessage:"Bytes written in storage in this stage",uuid:"Out"},{center:!0,uuid:"Out recs"},{center:!0,tooltipMessage:"Total shuffle bytes and records read, includes both data read locally and data read from remote executors.",uuid:"Sh read"},{rightAligned:!0,tooltipMessage:"Bytes and records written to disk in order to be read by a shuffle in a future stage.",uuid:"Sh write"}],getObjectAtRowIndex:function(e){return null==n?void 0:n[e]},buildApiOptionsFromObject:t?null:function(e){var t,n,i,r;return[null==e?void 0:e.stage_id,{application_id:null!=e&&null!==(t=e.application)&&void 0!==t&&t.calculated_id?encodeURIComponent(null==e||null===(n=e.application)||void 0===n?void 0:n.calculated_id):"",application_spark_ui_url:null!=e&&null!==(i=e.application)&&void 0!==i&&i.spark_ui_url?encodeURIComponent(null==e||null===(r=e.application)||void 0===r?void 0:r.spark_ui_url):"",quantiles:R.k$.map((function(e){return e})).join(","),withSummaries:!0}]},apiForFetchingAfterAction:t?null:C.ZP.spark_stages.detail,renderExpandedRowWithObject:t?null:function(e,t){var p,f,v=null==n?void 0:n[e];if(!v)return(0,S.jsx)("div",{});var j=v.details,x=v.num_active_tasks,b=v.num_complete_tasks,y=v.num_failed_tasks,E=v.num_killed_tasks,k=v.num_tasks,Z=null==t||null===(p=t.spark_stage)||void 0===p?void 0:p.stage_attempts;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.Z,{p:_.cd,children:(0,S.jsxs)(s.ZP,{children:[(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(a.Z,{noPadding:!0,children:[(0,S.jsx)(c.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(h.ZP,{bold:!0,large:!0,children:"Task summary"})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,I.s)([["Total",k],["Completed",b],["Active",x],["Failed",y],["Killed",E]])]})}),(0,S.jsx)(c.Z,{mr:_.cd}),(0,S.jsx)(u.Z,{flex:2,alignItems:"stretch",children:(0,S.jsxs)(a.Z,{noPadding:!0,children:[(0,S.jsx)(c.Z,{px:_.cd,py:_.cd,children:(0,S.jsx)(h.ZP,{bold:!0,large:!0,children:"Details"})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,S.jsx)(c.Z,{p:_.cd,children:null==j||null===(f=j.split("\n"))||void 0===f?void 0:f.map((function(e){return(0,S.jsx)(h.ZP,{muted:!0,monospace:!0,small:!0,children:e},e)}))})]})})]})}),null==Z?void 0:Z.map((function(e){e.attempt_id;var t,n=e.task_metrics_distributions,p=e.tasks,f=n||{},v=f.input_metrics,j=f.output_metrics,x=f.quantiles,b=void 0===x?R.k$:x,y=f.shuffle_read_metrics,E=f.shuffle_write_metrics,k=(0,S.jsx)(d.Z,{columnFlex:[null,null,null,null,null,null,null,null,null],columns:[{uuid:"ID"},{center:!0,uuid:"Attempt"},{uuid:"Status"},{uuid:"Locality"},{uuid:"Launch"},{center:!0,uuid:"Duration"},{center:!0,tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time"},{center:!0,tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Delayed"},{center:!0,tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result time"}],rows:(0,O.YC)(Object.values(p||{}),(function(e){return e.task_id}),{ascending:!1}).map((function(e){var t=e.attempt,n=e.duration,i=e.launch_time,o=e.scheduler_delay,u=e.status,s=e.task_id,a=e.task_locality,c=e.task_metrics;return[(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"taskId"}),s),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"attempt"}),t),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"status",success:R.q.SUCCESS===u}),u),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"taskLocality"}),a),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"launchTime"}),i?(0,P.XG)(l()(i,P.kE).format(P.BL),r):"-"),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"duration"}),n?(0,A.NR)(n):0),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"jvmGcTime"}),null!=c&&c.jvm_gc_time?(0,A.NR)(null==c?void 0:c.jvm_gc_time):0),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"schedulerDelay"}),o?(0,A.NR)(o):0),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"resultSerializationTime"}),null!=c&&c.result_serialization_time?(0,A.NR)(null==c?void 0:c.result_serialization_time):0)]}))});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(o.Z,{light:!0}),(0,S.jsx)(c.Z,{p:_.cd,children:(0,S.jsx)(w,{stageAttempt:e})}),(0,S.jsx)(o.Z,{light:!0}),(0,S.jsx)(c.Z,{px:_.cd,mt:_.cd,children:(0,S.jsx)(s.ZP,{children:(0,S.jsx)(u.Z,{flex:1,alignItems:"stretch",children:(0,S.jsxs)(a.Z,{noPadding:!0,children:[(0,S.jsx)(c.Z,{px:_.cd,py:_.cd,children:(0,S.jsxs)(h.ZP,{bold:!0,large:!0,children:["Summary metrics for ",(0,A._6)("completed task",null==e?void 0:e.num_complete_tasks)]})}),(0,S.jsx)(o.Z,{light:!0,short:!0}),(0,S.jsx)(d.Z,{columnFlex:[null].concat(null==b?void 0:b.map((function(){return null}))),columns:[{uuid:"Metric"}].concat((null==b?void 0:b.map((function(e,t){return{center:!0,label:function(){return 0===t?"Min":t===(null==b?void 0:b.length)-1?"Max":t===Math.floor((null==b?void 0:b.length)/2)?"Median":"".concat(Number(100*e),"th")},uuid:e}})))||[]),rows:[{uuid:"Duration",values:((null==n?void 0:n.duration)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"GC time is the total JVM garbage collection time.",uuid:"GC time",values:((null==n?void 0:n.jvm_gc_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Bytes read from storage in this stage.",uuid:"Input read (bytes)",values:(null==v?void 0:v.bytes_read)||[]},{tooltipMessage:"Records read from storage in this stage.",uuid:"Input records read",values:(null==v?void 0:v.records_read)||[]},{tooltipMessage:"Total shuffle bytes read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read (bytes)",values:(null==y?void 0:y.read_bytes)||[]},{tooltipMessage:"Total shuffle records read, includes both data read locally and data read from remote executors.",uuid:"Shuffle read records",values:(null==y?void 0:y.read_records)||[]},{uuid:"Shuffle read fetch time",values:((null==y?void 0:y.fetch_wait_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Bytes written to storage in this stage.",uuid:"Input write (bytes)",values:(null==j?void 0:j.bytes_written)||[]},{tooltipMessage:"Records written to storage in this stage.",uuid:"Input records write",values:(null==j?void 0:j.records_written)||[]},{tooltipMessage:"Bytes written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write (bytes)",values:(null==E?void 0:E.write_bytes)||[]},{tooltipMessage:"Records written to disk in order to be read by a shuffle in a future stage.",uuid:"Shuffle write records",values:(null==E?void 0:E.write_records)||[]},{uuid:"Shuffle write time",values:((null==E?void 0:E.write_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:(null==n?void 0:n.scheduler_delay)||[]},{uuid:"Task deserialization time",values:((null==n?void 0:n.executor_deserialize_time)||[]).map((function(e){return(0,A.NR)(e)}))},{uuid:"Task deserialization CPU time",values:((null==n?void 0:n.executor_deserialize_cpu_time)||[]).map((function(e){return(0,A.NR)(e)}))},{uuid:"Result size",values:(null==n?void 0:n.result_size)||[]},{tooltipMessage:"Result serialization time is the time spent serializing the task result on an executor before sending it back to the driver.",uuid:"Result serialization time",values:((null==n?void 0:n.result_serialization_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Getting result time is the time that the driver spends fetching task results from workers.",uuid:"Getting result time",values:((null==n?void 0:n.getting_result_time)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Scheduler delay is the time the task waits to be scheduled for execution.",uuid:"Scheduler delay",values:((null==n?void 0:n.scheduler_delay)||[]).map((function(e){return(0,A.NR)(e)}))},{tooltipMessage:"Peak execution memory is the maximum memory used by the internal data structures created during shuffles, aggregations and joins.",uuid:"Peak execution memory",values:(null==n?void 0:n.peak_execution_memory)||[]},{tooltipMessage:"Shuffle spill (memory) is the size of the deserialized form of the shuffled data in memory.",uuid:"Memory spilled (bytes)",values:(null==n?void 0:n.memory_bytes_spilled)||[]},{tooltipMessage:"Shuffle spill (disk) is the size of the serialized form of the data on disk.",uuid:"Disk spilled (bytes)",values:(null==n?void 0:n.disk_bytes_spilled)||[]}].map((function(e){var t=e.tooltipMessage,n=e.uuid,i=e.values;return[(0,S.jsxs)(s.ZP,{alignItems:"center",children:[(0,S.jsx)(h.ZP,D(D({},M.eB),{},{children:n})),t&&(0,S.jsx)("div",{style:{marginLeft:4},children:(0,S.jsx)(g.Z,{appearAbove:!0,label:(0,S.jsx)(h.ZP,{leftAligned:!0,children:t}),lightBackground:!0,maxWidth:200,muted:!0})})]},n)].concat(null==i?void 0:i.map((function(e,t){return(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"quantile-".concat(b[t],"-").concat(n)}),e)})))}))}),(0,S.jsx)(c.Z,{p:1})]})})})}),(0,S.jsx)(c.Z,{p:_.cd,children:(0,S.jsxs)(h.ZP,{bold:!0,large:!0,children:["Tasks   ",(0,S.jsx)(h.ZP,{default:!0,inline:!0,large:!0,monospace:!0,children:p?null===(t=Object.keys(p||{}))||void 0===t?void 0:t.length:""})]})}),!i&&k,i&&(0,S.jsx)(c.Z,{px:_.cd,children:(0,S.jsxs)(a.Z,{noPadding:!0,children:[k,(0,S.jsx)(c.Z,{pb:_.cd})]})}),(0,S.jsx)(c.Z,{p:1})]})}))]})},rows:null==n?void 0:n.map((function(e){var t=e.attempt_id,n=e.completion_time,i=e.first_task_launched_time,o=e.input_bytes,u=e.input_records,s=e.name,a=e.output_bytes,c=e.output_records,d=e.shuffle_read_bytes,p=e.shuffle_write_bytes,f=e.stage_id,g=e.status,v=e.submission_time,_=e.tasks,j=i&&l()(i,P.kE),x=n&&l()(n,P.kE),b=x&&x.diff(j),y=(null==s?void 0:s.length)>=12?"".concat(null==s?void 0:s.slice(0,9),"..."):s;return[(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"stageID"}),f),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"attemptID"}),t),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"displayName",title:s}),y),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"submissionTime"}),v?(0,P.XG)(l()(v,P.kE).format(P.BL),r):"-"),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"diffDisplayText",center:!0}),b?(0,A.NR)(b):0),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"status",success:R.Dd.COMPLETE===g}),g),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"tasks",center:!0}),Object.keys(_||{}).length||0),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"inputBytes"}),o),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"inputRecords"}),u),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"outputBytes"}),a),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"outputRecords"}),c),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{center:!0,key:"shuffleReadBytes"}),d),(0,m.createElement)(h.ZP,D(D({},M.eB),{},{key:"shuffleWriteBytes",rightAligned:!0}),p)]}))})}},8970:function(e,t,n){n.d(t,{sY:function(){return S},l:function(){return P},Eb:function(){return Z},LF:function(){return O},B2:function(){return E},Ts:function(){return b},TD:function(){return k},uK:function(){return x},eB:function(){return w},kI:function(){return C}});var i=n(82394),r=n(28598),l=69.063,o=l/85;var u,s,a,c,d=function(e){var t,n,i=e.height,u=e.size,s=e.width;return u?(t=u/o,n=u):i?(t=i,n=i*o):s&&(t=s/o,n=s),(0,r.jsxs)("svg",{fill:"#fff",fillRule:"evenodd",height:t,stroke:"#000",strokeLinecap:"round",strokeLinejoin:"round",viewBox:"0 0 ".concat(l," ").concat(85),width:n,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[(0,r.jsx)("use",{xlinkHref:"#A",x:"2.031",y:"2.5"}),(0,r.jsx)("symbol",{id:"A",overflow:"visible",children:(0,r.jsxs)("g",{stroke:"none",children:[(0,r.jsx)("path",{d:"M16.829 39.981L13.086 62.83l-9.812 2.283-3.255-1.659V39.981h16.81z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M65 31.932l-32.5 2.351L0 31.932 32.5 0 65 31.932z",fill:"#6b3b19"}),(0,r.jsx)("path",{d:"M38.971 39.981H3.274v25.132l35.697-8.322v-16.81z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M21.127 39.981l1.168 25.698-11.43 3.298-3.992-2.029V39.981h14.254z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M49.664 39.981H10.865v28.995l38.799-11.22V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M29.255 39.981v30.507l-8.912 3.317-5.016-2.556V39.981h13.929z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M58.117 39.981H20.342v33.824l37.775-14.078V39.981z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M26.019 76.703V39.981h24.602l11.803 24.771L32.49 80.001l-6.471-3.297z",fill:"#9d5025"}),(0,r.jsx)("path",{d:"M32.49 80.001v-40.02h32.5v23.464l-32.5 16.556zM65 31.932l-32.5-5.697V0L65 16.556v15.376z",fill:"#f58534"}),(0,r.jsx)("path",{d:"M0 31.932l32.5-5.697V0L0 16.556v15.376z",fill:"#9d5025"})]})})]})},p=n(55485),m=n(30160),f=n(72473),h=n(74260),g=n(70515),v=n(81728);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x,b,y=8*g.iI,E=j({},h.GO);!function(e){e.CLUSTERS="clusters",e.MONITORING="monitoring",e.RESOURCES="resources",e.SETUP="setup",e.SYSTEM="system"}(x||(x={})),function(e){e.EMR="emr_config",e.SPARK="spark_config"}(b||(b={}));var k=(u={},(0,i.Z)(u,x.CLUSTERS,"Clusters"),(0,i.Z)(u,x.RESOURCES,"Resources"),(0,i.Z)(u,x.MONITORING,"Monitoring"),(0,i.Z)(u,x.SETUP,"Setup"),(0,i.Z)(u,x.SYSTEM,"System"),u),P=(s={},(0,i.Z)(s,E.AWS_EMR,"AWS EMR"),(0,i.Z)(s,E.STANDALONE_CLUSTER,"Standalone cluster"),s),Z=(a={},(0,i.Z)(a,E.AWS_EMR,"Spark"),(0,i.Z)(a,E.STANDALONE_CLUSTER,"Spark"),a),O=(c={},(0,i.Z)(c,E.AWS_EMR,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return(0,r.jsx)(d,{height:e})})),(0,i.Z)(c,E.STANDALONE_CLUSTER,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y;return(0,r.jsx)(f.TripleBoxes,{size:e,warning:!0})})),c),S=[{buildPayload:function(e){return{emr_config:null,spark_config:j({app_name:"",spark_master:"local"},null==e?void 0:e.spark_config)}},displayName:P[E.STANDALONE_CLUSTER],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#standalone-spark-cluster",kicker:Z[E.STANDALONE_CLUSTER],renderIcon:O[E.STANDALONE_CLUSTER],uuid:E.STANDALONE_CLUSTER},{buildPayload:function(e){return{emr_config:j({master_instance_type:""},null==e?void 0:e.emr_config),spark_config:j({app_name:""},null==e?void 0:e.spark_config)}},displayName:P[E.AWS_EMR],documentationHref:"https://docs.mage.ai/integrations/spark-pyspark#aws",kicker:Z[E.AWS_EMR],renderIcon:O[E.AWS_EMR],uuid:E.AWS_EMR}],w={default:!0,monospace:!0,preWrap:!0,small:!0};function C(e){var t=[{Icon:f.Settings,uuid:x.SETUP},{Icon:f.DiamondGem,uuid:x.RESOURCES}];return h.GO.AWS_EMR===(null==e?void 0:e.uuid)&&t.push.apply(t,[{Icon:f.CubesThreeSeparated,renderStatus:function(e){var t=e.clusters;return e.clustersLoading?null:(0,r.jsx)(m.ZP,{default:!0,large:!0,monospace:!0,children:null==t?void 0:t.length})},uuid:x.CLUSTERS}]),[h.GO.AWS_EMR,h.GO.STANDALONE_CLUSTER].includes(null==e?void 0:e.uuid)&&t.push.apply(t,[{Icon:f.Monitor,renderStatus:function(e){var t=e.applications,n=e.applicationsLoading,i=e.jobs;e.jobsLoading;return n?null:(0,r.jsxs)(p.ZP,{flexDirection:"column",justifyContent:"flex-end",children:[(0,r.jsx)(m.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,v._6)("application",(null==t?void 0:t.length)||0)}),(0,r.jsx)("div",{style:{marginBottom:g.iI/2}}),(0,r.jsx)(m.ZP,{default:!0,monospace:!0,rightAligned:!0,xsmall:!0,children:(0,v._6)("job",(null==i?void 0:i.length)||0)})]})},uuid:x.MONITORING},{Icon:f.BlockCubePolygon,uuid:x.SYSTEM}]),t}},10332:function(e,t,n){n.d(t,{d:function(){return s},s:function(){return a}});var i=n(75499),r=n(30160),l=n(74260),o=n(42122),u=n(28598);function s(e){if(!(0,o.Qr)((null==e?void 0:e.spark_config)||{}))return(0,o.Qr)((null==e?void 0:e.emr_config)||{})?l.GO.STANDALONE_CLUSTER:l.GO.AWS_EMR}function a(e){return(0,u.jsx)(i.Z,{columnFlex:[null,1],columns:[{uuid:"Attribute"},{uuid:"Value"}],rows:e.map((function(e){return[(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[0]},"attribute"),(0,u.jsx)(r.ZP,{monospace:!0,muted:!0,small:!0,children:e[1]},"value")]}))})}},74260:function(e,t,n){var i,r,l;n.d(t,{GO:function(){return i},IK:function(){return l},br:function(){return r}}),function(e){e.AWS_EMR="AWS_EMR",e.STANDALONE_CLUSTER="STANDALONE_CLUSTER"}(i||(i={})),function(e){e.COMPLETED="completed",e.ERROR="error",e.INCOMPLETE="incomplete"}(r||(r={})),function(e){e.ACTIVATE_CLUSTER="activate_cluster",e.AWS_ACCESS_KEY_ID="AWS_ACCESS_KEY_ID",e.AWS_SECRET_ACCESS_KEY="AWS_SECRET_ACCESS_KEY",e.CLUSTER_CONNECTION="cluster_connection",e.CONFIGURE="configure",e.CREDENTIALS="credentials",e.EC2_KEY_NAME="ec2_key_name",e.EC2_KEY_PAIR="ec2_key_pair",e.EC2_KEY_PATH="ec2_key_path",e.IAM_PROFILE="iam_instance_profile",e.LAUNCH_CLUSTER="launch_cluster",e.OBSERVABILITY="observability",e.PERMISSIONS="permissions",e.PERMISSIONS_SSH="permissions_ssh",e.REMOTE_VARIABLES_DIR="remote_variables_dir",e.SETUP="setup"}(l||(l={}))},88422:function(e,t,n){var i,r,l,o,u;n.d(t,{CN:function(){return i},Dd:function(){return r},k$:function(){return s},oD:function(){return u},q:function(){return o}}),function(e){e.FAILED="FAILED",e.RUNNING="RUNNING",e.SUCCEEDED="SUCCEEDED"}(i||(i={})),function(e){e.COMPLETE="COMPLETE",e.PENDING="PENDING",e.SKIPPED="SKIPPED"}(r||(r={})),function(e){e.NODE_LOCAL="NODE_LOCAL",e.PROCESS_LOCAL="PROCESS_LOCAL",e.RACK_LOCAL="RACK_LOCAL"}(l||(l={})),function(e){e.SUCCESS="SUCCESS"}(o||(o={})),function(e){e.COMPLETED="COMPLETED"}(u||(u={}));var s=[.01,.25,.5,.75,.99]},35185:function(e,t,n){var i=n(82394),r=n(91835),l=(n(82684),n(9518)),o=n(44897),u=n(42631),s=n(70515),a=n(28598);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=l.default.div.withConfig({displayName:"ProgressBar__ProgressBarContainerStyle",componentId:"sc-10x9ojc-0"})(["border-radius:","px;height:","px;overflow:hidden;position:relative;width:100%;",""],u.BG,.75*s.iI,(function(e){return"\n    background-color: ".concat((e.theme.monotone||o.Z.monotone).grey200,";\n  ")})),m=l.default.div.withConfig({displayName:"ProgressBar__ProgressBarStyle",componentId:"sc-10x9ojc-1"})(["height:inherit;position:absolute;"," "," "," ",""],(function(e){return!e.danger&&"\n    background-color: ".concat((e.theme.progress||o.Z.progress).positive,";\n  ")}),(function(e){return e.progress&&"\n    width: ".concat(e.progress,"%;\n  ")}),(function(e){return e.danger&&"\n    background-color: ".concat((e.theme.progress||o.Z.progress).negative,";\n  ")}),(function(e){return e.animateProgress&&"\n    animation: animate-progress ".concat(e.animateProgress.duration,"ms linear forwards;\n\n    @keyframes animate-progress {\n      0% {\n        width: ").concat(e.animateProgress.start,"%;\n      }\n\n      100% {\n        width: ").concat(e.animateProgress.end,"%;\n      }\n    }\n  ")}));t.Z=function(e){var t=(0,r.Z)({},e);return(0,a.jsx)(p,d(d({},t),{},{children:(0,a.jsx)(m,d({},t))}))}}}]);