"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7482],{14875:function(e,n,r){r.d(n,{Z3:function(){return t},ms:function(){return i},s7:function(){return o}});var t=[{autoComplete:"username",label:"Username",required:!0,uuid:"username"},{autoComplete:"email",disabled:!1,label:"Email",required:!0,type:"email",uuid:"email"}],o="password_current",i=[{autoComplete:"current-password",label:"Current password",type:"password",uuid:o},{autoComplete:"new-password",label:"New password",type:"password",uuid:"password"},{autoComplete:"new-password",label:"Confirm new password",type:"password",uuid:"password_confirmation"}]},36043:function(e,n,r){var t=r(82394),o=r(21831),i=r(75582),s=r(21764),u=r(82684),l=r(83455),a=r(71180),c=r(31882),d=r(55485),p=r(85854),f=r(44085),m=r(38276),b=r(30160),h=r(17488),v=r(5332),w=r(98464),g=r(82359),y=r(14875),Z=r(86735),j=r(50178),x=r(42122),O=r(72619),S=r(28598);function _(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function C(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_(Object(r),!0).forEach((function(n){(0,t.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}n.Z=function(e){var n=e.disabledFields,r=e.hideFields,_=e.newUser,P=e.onDeleteSuccess,I=e.onSaveSuccess,k=e.showDelete,E=e.title,T=e.user,R=(0,u.useState)(!0),A=R[0],D=R[1],N=(0,u.useState)({}),W=N[0],F=N[1],M=(0,u.useState)(null),U=M[0],q=M[1],L=((0,j.PR)()||{}).owner,B=v.ZP.statuses.list().data,G=(0,u.useMemo)((function(){var e;return(null==B||null===(e=B.statuses)||void 0===e?void 0:e[0])||{}}),[B]),H=G.project_type,K=G.project_uuid,z="global",Q=null,J=null;H===g.k.SUB?(z="project",Q=K):H===g.k.MAIN&&(J="The roles selected here will apply to this user globally.\n                If a user has both a global role and a workspace role,\n                then the role with higher access will take precedence.");var V=v.ZP.roles.list({entity:z,entity_ids:Q?[Q]:[],limit_roles:!!_},{revalidateOnFocus:!1}),X=V.data,Y=(V.mutate,(0,u.useMemo)((function(){return(null==X?void 0:X.roles)||[]}),[null==X?void 0:X.roles])),$=(0,l.Db)(_?v.ZP.users.useCreate():v.ZP.users.useUpdate(null==T?void 0:T.id),{onSuccess:function(e){return(0,O.wD)(e,{callback:function(e){var n=e.user,r=y.Z3.concat(y.ms).map((function(e){return e.uuid}));r.push("id");var t=(0,x.GL)(n,r);q(t),s.Am.success(_?"New user created successfully.":"User profile successfully updated.",{position:s.Am.POSITION.BOTTOM_RIGHT,toastId:"user-update-success-".concat(n.id)}),null==I||I(t)},onErrorCallback:function(e){var n=e.error,r=n.errors,t=n.exception,o=n.message,i=n.type;s.Am.error((null==r?void 0:r.error)||t||o,{position:s.Am.POSITION.BOTTOM_RIGHT,toastId:i})}})}}),ee=(0,i.Z)($,2),ne=ee[0],re=ee[1].isLoading,te=(0,l.Db)(v.ZP.users.useDelete(null==T?void 0:T.id),{onSuccess:function(e){return(0,O.wD)(e,{callback:function(){null==P||P()},onErrorCallback:function(e){var n=e.error,r=n.errors,t=n.message;alert(t),console.log(r)}})}}),oe=(0,i.Z)(te,2),ie=oe[0],se=oe[1].isLoading,ue=r?(0,o.Z)(r):[];_&&ue.push(y.s7);var le=!ue||!ue.includes(y.s7),ae=(0,w.Z)(T);(0,u.useEffect)((function(){if(T&&(!U||(null==ae?void 0:ae.id)!==(null==T?void 0:T.id))){var e=y.Z3.concat(y.ms).map((function(e){return e.uuid}));q((0,x.GL)(T,e))}null!=U&&U.password||null!=U&&U.password_confirmation?(null==U?void 0:U.password)!==(null==U?void 0:U.password_confirmation)?F({password_confirmation:"Password confirmation does not match."}):!le||null!=U&&U.password_current?F(null):F({password_current:"This field is required."}):null!=U&&U.password_current&&le?null!=U&&U.password&&null!=U&&U.password_confirmation?F(null):F({password:"This field is required.",password_confirmation:"This field is required."}):null!=U&&U.password_current||null!=U&&U.password||null!=U&&U.password_confirmation||F(null)}),[U,le,T,ae]);var ce=(0,u.useState)(!1),de=ce[0],pe=ce[1],fe=(0,u.useMemo)((function(){return(de?null==U?void 0:U.roles_new:null==T?void 0:T.roles_new)||[]}),[U,de,T]),me=(0,u.useMemo)((function(){var e=(null==Y?void 0:Y.map((function(e){return e.id})))||[];return null==fe?void 0:fe.filter((function(n){var r=n.id;return e.includes(r)}))}),[fe,Y]);return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(p.Z,{children:E||"Edit profile"}),(0,S.jsxs)("form",{children:[y.Z3.filter((function(e){var n=e.uuid;return!ue||!ue.includes(n)})).map((function(e){var n=e.autoComplete,r=e.disabled,o=e.label,i=e.required,s=e.type,u=e.uuid;return(0,S.jsx)(m.Z,{mt:2,children:(0,S.jsx)(h.Z,{autoComplete:n,disabled:r&&!_,label:o,onChange:function(e){D(!1),q((function(n){return C(C({},n),{},(0,t.Z)({},u,e.target.value))}))},primary:!0,required:i,setContentOnMount:!0,type:s,value:(null==U?void 0:U[u])||""})},u)})),!(null!=T&&T.owner)&&!(null!=ue&&ue.includes("roles"))&&(0,S.jsxs)(m.Z,{mt:2,children:[J&&(0,S.jsx)(m.Z,{mb:1,children:(0,S.jsx)(b.ZP,{children:J})}),(0,S.jsx)(f.Z,{disabled:null==n?void 0:n.includes("roles"),label:"Roles",onChange:function(e){var n=(0,Z.sE)(Y,(function(n){return n.id==e.target.value}));n&&(D(!1),pe(!0),q((function(e){var r={};return(0,Z.sE)(fe,(function(e){return e.id==(null==n?void 0:n.id)}))||(r={roles_new:[].concat((0,o.Z)(fe),[n])}),C(C({},e),r)})))},primary:!0,setContentOnMount:!0,children:Y.map((function(e){var n=e.id,r=e.name;return(0,S.jsx)("option",{value:n,children:r},r)}))}),(0,S.jsx)(m.Z,{mb:1}),(0,S.jsx)(d.ZP,{alignItems:"center",flexWrap:"wrap",children:null==me?void 0:me.map((function(e){var r=e.id,t=e.name;return(0,S.jsx)(m.Z,{mb:1,mr:1,children:(0,S.jsx)(c.Z,{disabled:null==n?void 0:n.includes("roles"),label:t,onClick:function(){D(!1),pe(!0),q((function(e){return C(C({},e),{},{roles_new:(0,Z.Od)(fe,(function(e){return e.id===r}))})}))},primary:!0})},"user_roles/".concat(t))}))})]}),(0,S.jsxs)(m.Z,{mt:5,children:[(0,S.jsx)(p.Z,{children:_?"Password":"Change password"}),y.ms.filter((function(e){var n=e.uuid;return!ue||!ue.includes(n)})).map((function(e){var n=e.autoComplete,r=e.disabled,o=e.label,i=e.required,s=e.type,u=e.uuid;return(0,S.jsx)(m.Z,{mt:2,children:(0,S.jsx)(h.Z,{autoComplete:n,disabled:r,label:o,meta:{error:null==W?void 0:W[u],touched:!(null==W||!W[u])},onChange:function(e){D(!1),q((function(n){return C(C({},n),{},(0,t.Z)({},u,e.target.value))}))},primary:!0,required:i,setContentOnMount:!0,type:s,value:(null==U?void 0:U[u])||""})},u)}))]}),(0,S.jsx)(m.Z,{mt:5,children:(0,S.jsxs)(d.ZP,{children:[(0,S.jsx)(a.ZP,{disabled:A||W&&!(0,x.Qr)(W),loading:re,onClick:function(){var e,n=C({},U);"roles_new"in n&&(n.roles_new=null===(e=U.roles_new)||void 0===e?void 0:e.map((function(e){return e.id})));ne({user:n})},primary:!0,children:_?"Create new user":"Update user profile"}),k&&L&&(0,S.jsx)(m.Z,{ml:1,children:(0,S.jsx)(a.ZP,{danger:!0,loading:se,onClick:function(){window.confirm("Are you sure you want to delete ".concat(U.username||U.email,"?"))&&ie()},children:"Delete user"})})]})})]})]})}},75083:function(e,n,r){r.d(n,{HF:function(){return i},L6:function(){return t}});var t,o=r(72473);function i(e,n,r){var i=e.owner,s=(e.roles,[{Icon:o.WorkspacesIcon,id:t.WORKSPACES,isSelected:function(){return t.WORKSPACES===r},label:function(){return"Workspaces"},linkProps:{href:"/manage"}}]);return i&&s.push({Icon:o.WorkspacesUsersIcon,id:t.USERS,isSelected:function(){return t.USERS===r},label:function(){return"Users"},linkProps:{href:"/manage/users"}}),s.push.apply(s,[{Icon:o.Settings,id:t.SETTINGS,isSelected:function(){return t.SETTINGS===r},label:function(){return"Settings"},linkProps:{href:"/manage/settings"}},{Icon:o.File,id:t.FILE_BROWSER,isSelected:function(){return t.FILE_BROWSER===r},label:function(){return"File browser"},linkProps:{href:"/manage/files"}}]),s}!function(e){e.WORKSPACES="workspaces",e.USERS="users",e.SETTINGS="settings",e.FILE_BROWSER="file_browser"}(t||(t={}))},59533:function(e,n,r){var t=r(82684),o=r(94629),i=r(5332),s=r(70515),u=r(75083),l=r(50178),a=r(28598);n.Z=function(e){var n=e.before,r=e.breadcrumbs,c=void 0===r?[]:r,d=e.children,p=e.errors,f=e.headerOffset,m=e.mainContainerHeader,b=e.pageName,h=e.setErrors,v=e.subheaderChildren,w=i.ZP.statuses.list().data,g=(0,t.useMemo)((function(){var e,n;return null==w||null===(e=w.statuses)||void 0===e||null===(n=e[0])||void 0===n?void 0:n.project_type}),[w]),y=(0,l.PR)()||{};return(0,a.jsx)(o.Z,{before:n,beforeWidth:n?50*s.iI:0,breadcrumbs:c,errors:p,headerOffset:f,mainContainerHeader:m,navigationItems:(0,u.HF)(y,g,b),setErrors:h,subheaderChildren:v,title:"Workspaces",uuid:"workspaces/index",children:d})}},31882:function(e,n,r){var t=r(9518),o=r(71180),i=r(55485),s=r(30160),u=r(44897),l=r(72473),a=r(70515),c=r(61896),d=r(28598),p=t.default.div.withConfig({displayName:"Chip__ChipStyle",componentId:"sc-1ok73g-0"})(["display:inline-block;"," "," "," "," "," ",""],(function(e){return!e.primary&&"\n    background-color: ".concat((e.theme.background||u.Z.background).tag,";\n  ")}),(function(e){return e.primary&&"\n    background-color: ".concat((e.theme.chart||u.Z.chart).primary,";\n  ")}),(function(e){return!e.small&&"\n    border-radius: ".concat((a.iI+c.Al)/2,"px;\n    height: ").concat(1.5*a.iI+c.Al,"px;\n    padding: ").concat(a.iI/1.5,"px ").concat(1.25*a.iI,"px;\n  ")}),(function(e){return e.small&&"\n    border-radius: ".concat((a.iI/2+c.Al)/2,"px;\n    height: ").concat(c.Al+a.iI/2+2,"px;\n    padding: ").concat(a.iI/4,"px ").concat(a.iI,"px;\n  ")}),(function(e){return e.xsmall&&"\n    border-radius: ".concat((a.iI/1+c.Al)/1,"px;\n    height: ").concat(20,"px;\n    padding: 4px 6px;\n  ")}),(function(e){return e.border&&"\n    border: 1px solid ".concat((e.theme.content||u.Z.content).muted,";\n  ")}));n.Z=function(e){var n=e.border,r=e.children,t=e.disabled,u=e.label,c=e.monospace,f=e.onClick,m=e.primary,b=e.small,h=e.xsmall;return(0,d.jsx)(p,{border:n,primary:m,small:b,xsmall:h,children:(0,d.jsx)(o.ZP,{basic:!0,disabled:t,noBackground:!0,noPadding:!0,onClick:f,transparent:!0,children:(0,d.jsxs)(i.ZP,{alignItems:"center",children:[r,u&&(0,d.jsx)(s.ZP,{monospace:c,small:b,xsmall:h,children:u}),!t&&f&&(0,d.jsx)("div",{style:{marginLeft:2}}),!t&&f&&(0,d.jsx)(l.Close,{default:m,muted:!m,size:b?a.iI:1.25*a.iI})]})})})}},80022:function(e,n,r){function t(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(n,{Z:function(){return t}})},15544:function(e,n,r){function t(e){return t=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},t(e)}r.d(n,{Z:function(){return t}})},13692:function(e,n,r){r.d(n,{Z:function(){return o}});var t=r(61049);function o(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),n&&(0,t.Z)(e,n)}},93189:function(e,n,r){r.d(n,{Z:function(){return i}});var t=r(12539),o=r(80022);function i(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return(0,o.Z)(e)}}}]);